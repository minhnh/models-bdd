Feature: {{ data.name }}
{%- if 'scene' in data %}
  Background:
    {%- if 'objects' in data.scene %}
    Given a set of objects
      | name |
      {% for obj_name in data.scene.objects -%}
        | {{ obj_name }} |
      {% endfor %}
    {%- endif -%}
    {%- if 'workspaces' in data.scene %}
    Given a set of workspaces
      | name |
      {% for ws_name in data.scene.workspaces -%}
        | {{ ws_name }} |
      {% endfor %}
    {%- endif -%}
    {%- if 'agents' in data.scene %}
    Given a set of agents
      | name |
      {% for agn_name in data.scene.agents -%}
        | {{ agn_name }} |
      {% endfor %}
    {%- endif %}
    Given specified objects, workspaces and agents are available
{%- endif %}

{% for scenario_data in data.criteria %}
  Scenario Outline: {{ scenario_data.name }}
    {% for clause in scenario_data.given_clauses %}
    {{ clause|safe }}{% endfor %}

    {%- if 'when_event' in scenario_data %}
    When "{{ scenario_data.when_event }}"
    {%- endif %}

    When behaviour "{{ scenario_data.behaviour }}" occurs

    {% for clause in scenario_data.then_clauses %}
    {{ clause|safe }}{% endfor %}

    Examples:
    |{% for var_name in scenario_data.variables %} {{ var_name }} | {%- endfor %}
    {% for var_data in scenario_data.variations -%}
      |{% for entity_name in var_data %} {{ entity_name|safe }} |{% endfor %}
    {% endfor %}
{%- endfor -%}
